:8000

# Enable file serving from the /srv directory (mounted from project root)
file_server

# Set the required headers for Cross-Origin Isolation.
# This is necessary for SharedArrayBuffer, which DuckDB-WASM uses for multi-threading.
header {
	Cross-Origin-Opener-Policy "same-origin"
	Cross-Origin-Embedder-Policy "require-corp"
}

# Reverse proxy for DataFusion HTTP server with CORS headers
handle_path /datafusion/* {
	reverse_proxy sql-shader-datafusion:8124 {
		header_down Access-Control-Allow-Origin *
		header_down Access-Control-Allow-Methods "GET, POST, OPTIONS"
		header_down Access-Control-Allow-Headers "Content-Type"
	}
}
